import{B as y}from"./base-D5I4uWGD.js";import{B as r,a as s,g as a,b as n}from"./index-BS8bT3jb.js";class b extends y{constructor(){super(...arguments),this.biometryType=r.none,this.biometryTypes=[],this.biometryIsEnrolled=!1,this.deviceIsSecure=!1}async checkBiometry(){const e=this.biometryType!==r.none,i=e&&this.biometryIsEnrolled;let t="",o=s.none;return e?this.biometryIsEnrolled||(t="Biometry is not enrolled",o=s.biometryNotEnrolled):(t="No biometry is available",o=s.biometryNotAvailable),Promise.resolve({isAvailable:i,strongBiometryIsAvailable:this.biometryIsEnrolled&&this.hasStrongBiometry(),biometryType:this.biometryType,biometryTypes:this.biometryTypes,deviceIsSecure:this.deviceIsSecure,reason:t,code:o})}hasStrongBiometry(){return this.biometryTypes.some(e=>e===r.faceId||e===r.touchId||e===r.fingerprintAuthentication)}async internalAuthenticate(e){const i=await this.checkBiometry();if(!(i.isAvailable&&confirm((e==null?void 0:e.reason)||`Authenticate with ${i.biometryTypes.map(t=>a(t)).join(" or ")}?`))){if(e!=null&&e.allowDeviceCredential){if(i.deviceIsSecure){if(confirm("Authenticate with device security?"))return;throw new n("User cancelled",s.userCancel)}else if(i.isAvailable)throw new n("Device is not secure",s.noDeviceCredential)}else if(!i.isAvailable)throw i.biometryType===r.none?new n("Biometry is not available",s.biometryNotAvailable):new n("Biometry is not enrolled",s.biometryNotEnrolled);throw new n("User cancelled",s.userCancel)}}async setBiometryType(e){if(e===void 0)return Promise.resolve();const i=Array.isArray(e)?e:[e];if(this.biometryTypes=[],this.biometryType=r.none,i.length===0)return Promise.resolve();if(m(i))this.biometryType=i[0],this.biometryType!==r.none&&(this.biometryTypes=i);else for(let t=0;t<i.length;t++)if(r.hasOwnProperty(i[t])){const o=r[i[t]];this.biometryType===r.none?this.biometryTypes=[]:this.biometryTypes.push(o),t===0&&(this.biometryType=o)}return Promise.resolve()}async setBiometryIsEnrolled(e){return this.biometryIsEnrolled=e,Promise.resolve()}async setDeviceIsSecure(e){return this.deviceIsSecure=e,Promise.resolve()}}function m(l){return Object.values(r).includes(l[0])}export{b as BiometricAuthWeb};
